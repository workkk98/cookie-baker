(function(e){function t(t){for(var n,c,i=t[0],u=t[1],s=t[2],p=0,f=[];p<i.length;p++)c=i[p],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&f.push(a[c][0]),a[c]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,s||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,i=1;i<r.length;i++){var u=r[i];0!==a[u]&&(n=!1)}n&&(o.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},a={app:0},o=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},acc7:function(e,t,r){},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=(r("202f"),r("acc7"),r("5efb")),o=r("98c5"),c=r("55f1"),i=r("0c63"),u=r("0020"),s=r("a79d8"),l=r("b558"),p=r("3af3"),f=r("ed3b"),m=r("9839"),d=r("59a5"),v=r("f933"),b=r("f64c"),h=(r("d81d"),r("a9e3"),r("d3b7"),r("25f0"),r("d4ec")),y=r("bee2"),g=r("262e"),w=r("2caf"),k=r("9ab4"),x=r("1b40"),O=(r("4de4"),r("4d63"),r("ac1f"),r("5319"),r("5530")),j=(r("96cf"),r("1da1"));r("cb29"),r("b0c0");function R(e){return"http"+(e.secure?"s":"")+"://"+e.domain+e.path}var P=[{name:"visitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitoridvisitorid",value:"0f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b00000f6803174d7c00001cbe2b6038000000290b0000",domain:"www.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cnwww.bmw.com.cn",path:"/content/bmw/marketCN/bmw_com_cn/zh_CN/index/jcr:content/par/multicontent/tabs/multicontenttab_414046302/items/smallteaser_1006813621/image.transform/smallteaser"},{name:"cf_chl_seq_ad6dda397271c74",value:"5c28ab63def3a41",domain:"www.woodwood.com",path:"/cdn-cgi/challenge-platform/h/g/generate/ov1/0.15999413329210949:1603638120:43a2d323d06760329beb089d5ba890344ba1bdd91b3d605c963f92f85d478e4b/5e7cf2971df2eb5d"}];function C(){return S.apply(this,arguments)}function S(){return S=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){chrome.cookies?chrome.cookies.getAll({},(function(t){e(t)})):e(new Array(20).fill(P[0]))})));case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function $(e){var t,r="http"+(e.secure?"s":"")+"://"+e.domain+e.path;null===(t=chrome.cookies)||void 0===t||t.remove({url:r,name:e.name})}function E(e){var t=e.name,r=e.value;return new Promise((function(n,a){var o;null===(o=chrome.cookies)||void 0===o||o.set({url:R(e),name:t,value:r},(function(e){e?n(e):a("set cookie error")}))}))}function _(e,t,r,n){return e("a-input",{props:{value:r[t],disabled:null===n||void 0===n?void 0:n.disabled},on:{"change.value":function(e){return r[t]=e}}})}function D(e){return function(t){return t("a-form",{props:{labelCol:{span:5},wrapperCol:{span:16}}},[t("a-form-item",{props:{label:"名称"}},[_(t,"name",e)]),t("a-form-item",{props:{label:"值"}},[_(t,"value",e)]),t("a-form-item",{props:{label:"域名"}},[_(t,"domain",e,{disabled:!0})]),t("a-form-item",{props:{label:"路径"}},[_(t,"path",e,{disabled:!0})])])}}function A(e){var t=Object.assign({},e);return null===f["a"]||void 0===f["a"]?void 0:f["a"].confirm({title:"编辑cookie",width:600,content:D(t),onOk:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E(t);case 3:n["a"].prototype.$message.success("设置cookie成功"),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),n["a"].prototype.$messagee.error("编辑cookie失败");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function r(){return e.apply(this,arguments)}return r}()})}var I,M=[{title:"名称",dataIndex:"name",key:"name",width:200,ellipsis:!0},{title:"值",dataIndex:"value",key:"value",width:400,ellipsis:!0},{title:"域名",dataIndex:"domain",key:"domain",width:300,ellipsis:!0},{title:"路径",key:"path",dataIndex:"path",ellipsis:!0},{title:"操作",key:"action",scopedSlots:{customRender:"action"},width:160}],T=function(e){Object(g["a"])(r,e);var t=Object(w["a"])(r);function r(){var e;return Object(h["a"])(this,r),e=t.apply(this,arguments),e.searchVal="",e}return Object(y["a"])(r,[{key:"created",value:function(){this.fetchData()}},{key:"filterData",value:function(e){this.searchVal=e;var t=new RegExp(e.replace(".","\\."));this.fetchData(t)}},{key:"fetchData",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:r=e.sent,I=r.filter((function(e){return!t||t.test(e.domain)})).map((function(e,t){return Object(O["a"])(Object(O["a"])({},e),{},{key:t})})),this.$forceUpdate();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeCookie",value:function(e){$(e),this.filterData(this.searchVal)}},{key:"render",value:function(){var e=arguments[0];return e("div",null,[e("a-input-search",{style:"width: 200px",attrs:{placeholder:"请输入域名"},on:{search:this.filterData}},[]),e("a-table",{style:"margin-top: 16px",attrs:{columns:M,"data-source":I},scopedSlots:{action:this.createActionColumns()}},[])])}},{key:"createActionColumns",value:function(){var e=this,t=this.$createElement;return function(r,n){return t("span",null,[t("a",{on:{click:function(){A(n)}}},["编辑"]),t("a-divider",{attrs:{type:"vertical"}},[]),t("a",{on:{click:function(){e.removeCookie(n)}}},["删除"])])}}}]),r}(x["b"]);T=Object(k["a"])([x["a"]],T);var N=T,z=(r("99af"),r("1276"),r("ade3"));function J(e,t){return new Promise((function(r,n){var a,o;null===(a=chrome.storage)||void 0===a||null===(o=a.sync)||void 0===o||o.set(Object(z["a"])({},e,t),(function(){var e;if(null!==(e=chrome.runtime)&&void 0!==e&&e.lastError)return n(chrome.runtime.lastError),void(chrome.runtime.lastError=void 0);r(!0)}))}))}function L(e){return new Promise((function(t,r){var n,a;null===(n=chrome.storage)||void 0===n||null===(a=n.sync)||void 0===a||a.get([e],(function(n){var a,o;if(console.log("storage.sync.get: ",n[e]),null!==(a=chrome.runtime)&&void 0!==a&&a.lastError)return r(chrome.runtime.lastError),void(chrome.runtime.lastError=void 0);t(null!==(o=n[e])&&void 0!==o?o:"")}))}))}function K(e){return new Promise((function(t,r){chrome.storage.sync.remove(e,(function(){var e;if(null!==(e=chrome.runtime)&&void 0!==e&&e.lastError)return r(chrome.runtime.lastError),void(chrome.runtime.lastError=void 0);t(!0)}))}))}var V="strategyID";function U(e,t){return t?"".concat(t,";").concat(JSON.stringify(e)):"".concat(JSON.stringify(e))}function q(e){if(0===e.length)return[];var t=e.split(";");return t.map((function(e){try{return JSON.parse(e)}catch(t){return console.error(t),null}})).filter((function(e){return null!==e}))}var B=function(){function e(){Object(h["a"])(this,e),this.strategyList=[],this.strategyStr=""}return Object(y["a"])(e,[{key:"get",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t||!(this.strategyList.length>0)){e.next=2;break}return e.abrupt("return",this.strategyList);case 2:return e.prev=2,e.next=5,L(V);case 5:return r=e.sent,this.strategyStr=r,e.abrupt("return",this.strategyList=q(r));case 10:return e.prev=10,e.t0=e["catch"](2),console.error(e.t0),n["a"].prototype.$message.error(e.t0.message),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"set",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(V,U(t,this.strategyStr));case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e["catch"](0),console.error(e.t0),n["a"].prototype.$message.error(e.t0.message),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeAll",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K(V);case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e["catch"](0),console.error(e.t0),n["a"].prototype.$message.error(e.t0.message),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),F=new B;function G(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.domain&&e.path}function H(e,t,r){return new Promise((function(n,a){chrome.cookies.set({url:e,name:t,value:r},(function(e){console.log("cookie-set",e),e||a(null),n(e)}))}))}function Q(e){return new Promise((function(t,r){var n;null===(n=chrome.cookies)||void 0===n||n.get(e,(function(e){t(e)}))}))}function W(e,t,r){return X.apply(this,arguments)}function X(){return X=Object(j["a"])(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Q({name:n,url:t});case 2:if(a=e.sent,null!==a){e.next=6;break}return console.warn("啊哦，没找到对应的cookie，确认下url:".concat(t,", name: ").concat(n)),e.abrupt("return");case 6:if(!G(a)){e.next=10;break}return e.next=9,H(r,n,a.value);case 9:console.log("cookie复制与粘贴已生效");case 10:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}var Y=/\b((?=[a-z0-9-]{1,63}\.)(xn--)?[a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,63}\b/,Z=/(?:([01]?\d\d?|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d\d?|2[0-4]\d|25[0-5])/,ee=/localhost/;function te(e){return Z.test(e)||Y.test(e)||ee.test(e)}function re(e){return"string"===typeof e&&!!e}function ne(e,t,r){return re(e)&&te(t)&&te(r)}function ae(e,t){return e("a-select-option",{props:{value:t}},[t])}function oe(e,t,r){return e("a-input",{props:{value:t[r]},on:{"change.value":function(e){return t[r]=e}}},[e("a-select",{slot:"addonBefore",props:{value:t[r+"Protocol"]},on:{change:function(e){t[r+"Protocol"]=e}}},[ae(e,"http://"),ae(e,"https://")])])}function ce(e,t,r){return e("a-radio-group",{props:{value:t[r]},attrs:{"button-style":"solid"},on:{input:function(e){return t[r]=e}}},[e("a-radio-button",{attrs:{value:"copy"}},["拷贝策略"])])}function ie(e){return function(t){return t("a-form",{props:{labelCol:{span:5},wrapperCol:{span:16}}},[t("a-form-item",{props:{label:"源url"}},[oe(t,e,"origin")]),t("a-form-item",{props:{label:"name"}},[t("a-input",{props:{value:e.name},on:{"change.value":function(t){return e.name=t}}})]),t("a-form-item",{props:{label:"目标url"}},[oe(t,e,"target")]),t("a-form-item",{props:{label:"策略名称",value:e.strategy}},[ce(t,e,"strategy")])])}}function ue(e){var t=x["b"].observable({origin:"",originProtocol:"http://",name:"",target:"",strategy:"copy",targetProtocol:"http://"});return null===f["a"]||void 0===f["a"]?void 0:f["a"].confirm({title:"创建策略",width:600,content:ie(t),onOk:function(){var r=Object(j["a"])(regeneratorRuntime.mark((function r(){var n,a,o,c,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log(t),n=t.origin,a=t.originProtocol,o=t.name,c=t.target,i=t.strategy,u=t.targetProtocol,ne(o,n,c)){r.next=5;break}return x["b"].prototype.$message.error("请检查form表单"),r.abrupt("return");case 5:return r.next=7,F.set({origin:a+n,name:o,target:u+c,strategy:i});case 7:W(a+n,u+c,o),x["b"].prototype.$message.success("策略创建成功"),e();case 10:case"end":return r.stop()}}),r)})));function n(){return r.apply(this,arguments)}return n}()})}var se=[{title:"名称",dataIndex:"name",key:"name"},{title:"源url",dataIndex:"origin",key:"origin"},{title:"目标url",key:"target",dataIndex:"target"},{title:"策略名称",key:"strategy",dataIndex:"strategy"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],le=function(e){Object(g["a"])(r,e);var t=Object(w["a"])(r);function r(){var e;return Object(h["a"])(this,r),e=t.apply(this,arguments),e.data=[],e}return Object(y["a"])(r,[{key:"created",value:function(){this.fetchData()}},{key:"render",value:function(){var e=arguments[0];return e("div",null,[e("a-button",{attrs:{type:"primary"},on:{click:this.openModal}},["新建策略"]),e("a-divider",{attrs:{type:"vertical"}},[]),e("a-button",{attrs:{type:"primary"},on:{click:this.fetchData}},["刷新策略"]),e("a-divider",{attrs:{type:"vertical"}},[]),e("a-button",{attrs:{type:"primary"},on:{click:this.removeAll}},["移除所有"]),e("a-table",{style:"margin-top: 16px",attrs:{columns:se,"data-source":this.data},scopedSlots:{action:this.createActionColumns()}},[])])}},{key:"fetchData",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.get(!0);case 2:t=e.sent,this.data=t.map((function(e,t){return Object(O["a"])({key:t.toString()},e)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"removeAll",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.removeAll();case 2:x["b"].prototype.$message.success("移除成功"),this.fetchData();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"createActionColumns",value:function(){var e=this.$createElement;return function(t,r){return e("span",null,[e("a",{on:{click:function(){x["b"].prototype.$message.success("已执行"),W(r.origin,r.target,r.name)}}},["立即执行"])])}}},{key:"openModal",value:function(){var e=this;ue((function(){e.fetchData()}))}}]),r}(x["b"]);le=Object(k["a"])([x["a"]],le);var pe=le,fe=[{icon:"user",title:"cookie"},{icon:"video-camera",title:"追踪策略"}],me=function(e){Object(g["a"])(r,e);var t=Object(w["a"])(r);function r(){var e;return Object(h["a"])(this,r),e=t.apply(this,arguments),e.collapsed=!1,e.ctorKey="0",e}return Object(y["a"])(r,[{key:"render",value:function(){var e=this,t=arguments[0],r=this.createMenu();return t("a-layout",null,[t("a-layout-sider",{attrs:{collapsed:this.collapsed,trigger:null,collapsible:!0}},[r]),t("a-layout",null,[t("a-layout-header",{style:"background: #fff;"},[t("a-icon",{class:"trigger",attrs:{type:this.collapsed?"menu-unfold":"menu-fold"},on:{click:function(){return e.collapsed=!e.collapsed}}},[])]),t("a-layout-content",{style:"margin: 24px 16px; padding: 24px; background: rgb(255, 255, 255); min-height: calc(100vh - 112px)"},[this.createComponent()])])])}},{key:"createMenu",value:function(){var e=this.$createElement,t=fe.map((function(t,r){return e("a-menu-item",{key:r.toString()},[e("a-icon",{attrs:{type:t.icon}},[]),e("span",null,[t.title])])}));return e("a-menu",{attrs:{theme:"dark",mode:"inline","default-selected-keys":["0"]},on:{click:this.selectComponent}},[t])}},{key:"createCookie",value:function(){var e=this.$createElement;return e("cookie-table",null,[])}},{key:"createTrace",value:function(){var e=this.$createElement;return e("trace-table",null,[])}},{key:"createComponent",value:function(){var e=[this.createCookie,this.createTrace];return e[Number(this.ctorKey)]()}},{key:"selectComponent",value:function(e){this.ctorKey=e.key,this.$forceUpdate()}}]),r}(x["b"]);me=Object(k["a"])([Object(x["a"])({components:{CookieTable:N,TraceTable:pe}})],me);var de,ve,be=me,he=(r("4160"),r("159b"),r("b85c")),ye=function(){function e(){Object(h["a"])(this,e),this.name="copy"}return Object(y["a"])(e,[{key:"hit",value:function(e){return e===this.name}},{key:"excute",value:function(e,t,r){console.log("excute: ",e,t,r),H(e,t,r)}}]),e}(),ge=[new ye];function we(e,t){return ke.apply(this,arguments)}function ke(){return ke=Object(j["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.get(!1);case 2:n=e.sent,a=Object(he["a"])(n);try{for(c=function(){var e=o.value,n=e.origin,a=e.strategy,c=e.target,i=e.name;console.log("策略: ",e),n===t&&i===r.name&&ge.forEach((function(e){e.hit(a)&&e.excute(c,i,r.value)}))},a.s();!(o=a.n()).done;)c()}catch(i){a.e(i)}finally{a.f()}case 5:case"end":return e.stop()}}),e)}))),ke.apply(this,arguments)}null===(de=chrome.cookies)||void 0===de||null===(ve=de.onChanged)||void 0===ve||ve.addListener((function(e){e.removed||(console.log("cookie变动",e.cookie),we(R(e.cookie),e.cookie))})),n["a"].config.productionTip=!1,n["a"].use(a["a"]),n["a"].use(o["a"]),n["a"].use(c["a"]),n["a"].use(i["a"]),n["a"].use(u["a"]),n["a"].use(s["a"]),n["a"].use(l["a"]),n["a"].use(p["a"]),n["a"].use(f["a"]),n["a"].use(m["b"]),n["a"].use(d["a"]),n["a"].use(v["a"]),n["a"].prototype.$message=b["a"],new n["a"]({render:function(e){return e(be)}}).$mount("#app")}});
//# sourceMappingURL=app.90a0e8df.js.map